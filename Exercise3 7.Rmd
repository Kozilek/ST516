---
title: "Exercise 3.7 Ross"
author: "Emil H. Andersen"
date: "April 21, 2016"
output: html_document
---

Exercise 3.7 in Ross book: Use simulation to approximate the following integral:
$$\int_\infty^\infty e^{-x^2} dx$$ Using the method described in chapter 3.2 of the Ross book. The result should be compared to the exact result if possible.

I first view the graph to see which area is relevant to estimate the integral

```{r}
x = seq(-25,25,(1/10))
f = exp(-x^2)
plot(x,f,type="l")
```

As it is easily observed that the area is at least in the interval $x \in [-10,10]$, I will estimate the integral within this interval. I first start by creating a vector to contain the 21 pieces that will be generated by estimating the integral in the previously mentioned interval. I do the simulation using a million random variables per run through to optimize the precision. Ux is the P is the vector of the part-results.

```{r}
P<- rep(0,21)
for (i in -10:10){
  a = i 
  b = i + 1
  Ux <- runif(1000000)
  Ux <- Ux * (b-a) + a
  f <- exp(-Ux^2)
  P[i+11] <- sum(f)/(1000000)
}
sum(P)
```
To get the exact result, a combination of calculus, polar coordinates and integration by substitution is necessary: $$\left( \int_{-\infty}^{\infty} e^{-x^2} dx \right) ^2 = \int_{-\infty}^{\infty} e^{-x^2} dx \cdot \int_{-\infty}^{\infty} e^{-y^2} dy = \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} e^{-(x^2+y^2)} dxdy$$ Now using polar coordinates, we get: $$\int \int_{R^2} e^{-(x^2+y^2)} d(x,y) = \int_{0}^{2\pi} \int_{0}^{\infty} e^{-(-r^2)}r dr d\theta$$ Integrating first the $\theta$ part yields the result $$2 \pi \int_{0}^{\infty} e^{-(-r^2)}r dr$$ Now substituting $u = -r^2$, $-du \cdot {1 \over 2r} = dr$ results in the following: $$2\pi \int_0^{\infty} {1 \over 2} e^u du = \pi [e^{-r^2}]_0^{\infty} = \pi$$ Now since $$\left( \int_{-\infty}^{\infty} e^{-x^2} dx \right) ^2 = \pi$$ then $$\int_{-\infty}^{\infty} e^{-x^2} dx = \sqrt{\pi} \approx 1.77245$$